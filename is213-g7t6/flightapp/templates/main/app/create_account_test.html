<!DOCTYPE html>
<html lang="en">
	
  <head>
    <title>Create Account</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abril+Fatface" rel="stylesheet">

    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/ionicons.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    
	  <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
	    <div class="container">
	      <a class="navbar-brand" href="about.html">Fly Like T6</a>
	      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
	        <!-- <span class="oi oi-menu"></span> Menu -->
	      </button>

	      <!-- <div class="collapse navbar-collapse" id="ftco-nav">
	        <ul class="navbar-nav ml-auto">
	          
				<li class="nav-item"><a href="about.html" class="nav-link">About</a></li>
				<!-- <li class="nav-item"><a href="search_flights.html" class="nav-link">Search Flights</a></li> -->
				<!-- <li class="nav-item"><a href="manage_booking.html" class="nav-link">My Bookings</a></li>
				<li class="nav-item"><a href="about.html" class="nav-link">Logout</a></li> -->

	          
	        </ul>
	      </div> -->
	    </div>
	  </nav>
    <!-- END nav -->
    
    <div class="hero-wrap js-fullheight" style="background-image: url('images/bg_1.jpg');">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-center justify-content-start" data-scrollax-parent="true">
          <div class="col-md-9 ftco-animate mb-5 pb-5 text-center text-md-left" data-scrollax=" properties: { translateY: '70%' }">
            <h1 class="mb-4" data-scrollax="properties: { translateY: '30%', opacity: 1.6 }">Create Account</h1>
            <p data-scrollax="properties: { translateY: '30%', opacity: 1.6 }">Book flights to travel around the world</p>
		  
		</div>
        </div>
      </div>
    </div>

    <section >
    	<div class="container-wrap ml-auto">
    		<div class="row no-gutters">
          <div class="col-md-12 nav-link-wrap">
            <div class="nav nav-pills justify-content-center text-center" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <!-- <a class="nav-link active" id="v-pills-1-tab" data-toggle="pill" href="create_account.html" role="tab" aria-controls="v-pills-1" aria-selected="true">Create an account</a> -->
              <!-- <a class="nav-link active" onclick="location.href = 'create_account_test.html'">Dont have an account? Click here to create one now!</a> -->
            </div>
          </div>
          <div class="col-md-12 tab-wrap"> 
        <!-- this makes the form wide -->
          <!-- <div> -->
            <div class="tab-content p-4 px-5" id="v-pills-tabContent">

              <div class="tab-pane fade show active" id="v-pills-1" role="tabpanel" aria-labelledby="v-pills-nextgen-tab">
                  <form id="create_accountForm" class="search-destination" 
                 
                  >
              		<div class="row">
              			<div class="col-md align-items-end">
              				<div class="form-group">
              					<!-- <label for="email">Email</label> -->
	              				<div class="form-field">
	              					<!-- <div class="icon"><span class="icon-my_location"></span></div> -->
                                    First Name<input type="text" id = "firstName" class="form-control" placeholder="Enter your First name or Given name"> &nbsp;
                                    Last Name <input type="text" id = "lastName" class="form-control" placeholder="Enter your Last Name"> &nbsp;
                                    Email<input type="text" id = "email" class="form-control" placeholder="Email"> &nbsp;
                                    Password<input type="password" id = "password" class="form-control" placeholder="Password"> &nbsp;
                                    Username<input type="text" id = "pid" class="form-control" placeholder = "Please enter a unique username"> &nbsp;
                                    Date of Birth<input type="date" id = "dateOfBirth" class="form-control" placeholder="Enter your date of birth in yyyy-mm-dd format, eg. 1976-12-12"> &nbsp;
                                    Contact Number<input type="text" id = "contactNo" class="form-control" placeholder="Enter your mobile number eg. 99330292"> &nbsp;
                                    <button type="submit" value="Login" class="form-control btn btn-primary" >Create account now!</button>
                                </div>
				              </div>
                    </div>
                    <script src="js/jquery.min.js"></script>
                    <script src="js/jquery-migrate-3.0.1.min.js"></script>
                    <script src="js/popper.min.js"></script>
                    <script src="js/bootstrap.min.js"></script>
                    <script src="js/jquery.easing.1.3.js"></script>
                    <script src="js/jquery.waypoints.min.js"></script>
                    <script src="js/jquery.stellar.min.js"></script>
                    <script src="js/owl.carousel.min.js"></script>
                    <script src="js/jquery.magnific-popup.min.js"></script>
                    <script src="js/aos.js"></script>
                    <script src="js/jquery.animateNumber.min.js"></script>
                    <script src="js/bootstrap-datepicker.js"></script>
                    <!--    <script src="js/jquery.timepicker.min.js"></script>-->
                    <script src="js/scrollax.min.js"></script>
                    <!--    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>-->
                    <!--    <script src="js/google-map.js"></script>-->
                    <script src="js/main.js"></script>
              			
              
                          <script>
                            // Helper function to display error message
                            function showError(message) {
                              // Display an error under the the predefined label with error as the id
                              $('#error').text(message);
                            }
                          
                            $("#create_accountForm").submit(async (event) => {
                              //Prevents screen from refreshing when submitting
                              event.preventDefault();
                          
                              var serviceURL = "http://127.0.0.1:5002/passenger/register/";
                              // var homeURL = "http://127.0.0.1/bookstore/";
                          
                              //Get form data
                              var email = $('#email').val();
                              var password = $('#password').val();
                              var firstName = $('#firstName').val();
                              var lastName = $('#lastName').val();
                              var dateOfBirth = $('#dateOfBirth').val();
                              var contactNo = $('#contactNo').val();
                              var pid = $('#pid').val();
                          
                              serviceURL += email;
                          
                              try {
                                const response =
                                  await fetch(
                                    serviceURL, {
                                      method: 'POST',
                                      headers: {"Content-Type": "application/json"},
                                      body: JSON.stringify({
                                        pid: pid,
                                        password: password,
                                        email: email,
                                        firstName: firstName,
                                        lastName: lastName,
                                        dateOfBirth: dateOfBirth,
                                        contactNo: contactNo
                                      })
                                    });
                                const data = await response.json();
                          
                                if (response.ok) {
                                  document.location.href = "search_flights.html";
                          
                                  // // relocate to home page
                                  // window.location.replace(homeURL);
                                  return false;
                                } else {
                                  console.log(data);
                                  showError(data.message);
                                }
                              } catch (error) {
                                // Errors when calling the service; such as network error,
                                // service offline, etc
                                showError
                                ("A problem occurred when creating your account, please try again later. " + error);
                          
                              } // error
                            });
                          </script>
                          

              
    
  </body>
</html>