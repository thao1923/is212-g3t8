2020-10-26 13:44:05,017 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,019 Model: "TextClassifier(
  (document_embeddings): DocumentLSTMEmbeddings(
    (embeddings): StackedEmbeddings(
      (list_embedding_0): WordEmbeddings('glove')
      (list_embedding_1): FlairEmbeddings(
        (lm): LanguageModel(
          (drop): Dropout(p=0.25, inplace=False)
          (encoder): Embedding(275, 100)
          (rnn): LSTM(100, 1024)
          (decoder): Linear(in_features=1024, out_features=275, bias=True)
        )
      )
      (list_embedding_2): FlairEmbeddings(
        (lm): LanguageModel(
          (drop): Dropout(p=0.25, inplace=False)
          (encoder): Embedding(275, 100)
          (rnn): LSTM(100, 1024)
          (decoder): Linear(in_features=1024, out_features=275, bias=True)
        )
      )
    )
    (word_reprojection_map): Linear(in_features=2148, out_features=128, bias=True)
    (rnn): GRU(128, 512)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (decoder): Linear(in_features=512, out_features=2, bias=True)
  (loss_function): CrossEntropyLoss()
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)"
2020-10-26 13:44:05,020 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,021 Corpus: "Corpus: 35240 train + 4405 dev + 4405 test sentences"
2020-10-26 13:44:05,023 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,024 Parameters:
2020-10-26 13:44:05,025  - learning_rate: "0.1"
2020-10-26 13:44:05,027  - mini_batch_size: "16"
2020-10-26 13:44:05,028  - patience: "3"
2020-10-26 13:44:05,029  - anneal_factor: "0.5"
2020-10-26 13:44:05,031  - max_epochs: "10"
2020-10-26 13:44:05,032  - shuffle: "True"
2020-10-26 13:44:05,033  - train_with_dev: "False"
2020-10-26 13:44:05,034  - batch_growth_annealing: "False"
2020-10-26 13:44:05,035 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,036 Model training base path: "."
2020-10-26 13:44:05,037 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,039 Device: cuda:0
2020-10-26 13:44:05,040 ----------------------------------------------------------------------------------------------------
2020-10-26 13:44:05,040 Embeddings storage mode: cpu
2020-10-26 13:44:05,042 ----------------------------------------------------------------------------------------------------
2020-10-26 13:50:37,866 epoch 1 - iter 220/2203 - loss 0.34368898 - samples/sec: 9.34 - lr: 0.100000
2020-10-26 13:57:38,891 epoch 1 - iter 440/2203 - loss 0.29127537 - samples/sec: 8.67 - lr: 0.100000
2020-10-26 14:04:02,750 epoch 1 - iter 660/2203 - loss 0.27487186 - samples/sec: 9.49 - lr: 0.100000
2020-10-26 14:10:40,374 epoch 1 - iter 880/2203 - loss 0.26395895 - samples/sec: 9.22 - lr: 0.100000
2020-10-26 14:16:58,244 epoch 1 - iter 1100/2203 - loss 0.25808389 - samples/sec: 9.64 - lr: 0.100000
2020-10-26 14:23:48,841 epoch 1 - iter 1320/2203 - loss 0.25066031 - samples/sec: 8.90 - lr: 0.100000
2020-10-26 14:30:34,847 epoch 1 - iter 1540/2203 - loss 0.24443937 - samples/sec: 8.95 - lr: 0.100000
2020-10-26 14:36:57,211 epoch 1 - iter 1760/2203 - loss 0.23876879 - samples/sec: 9.58 - lr: 0.100000
2020-10-26 14:43:31,982 epoch 1 - iter 1980/2203 - loss 0.23405029 - samples/sec: 9.26 - lr: 0.100000
2020-10-26 14:49:48,015 epoch 1 - iter 2200/2203 - loss 0.23082939 - samples/sec: 9.70 - lr: 0.100000
2020-10-26 14:49:54,787 ----------------------------------------------------------------------------------------------------
2020-10-26 14:49:54,788 EPOCH 1 done: loss 0.2308 - lr 0.1000000
2020-10-26 14:58:24,983 DEV : loss 0.16576135158538818 - score 0.9362
2020-10-26 14:58:49,234 BAD EPOCHS (no improvement): 0
saving best model
2020-10-26 14:58:54,562 ----------------------------------------------------------------------------------------------------
2020-10-26 15:05:19,524 epoch 2 - iter 220/2203 - loss 0.18581451 - samples/sec: 9.49 - lr: 0.100000
2020-10-26 15:11:59,749 epoch 2 - iter 440/2203 - loss 0.18720862 - samples/sec: 9.17 - lr: 0.100000
2020-10-26 15:18:22,995 epoch 2 - iter 660/2203 - loss 0.19369117 - samples/sec: 9.56 - lr: 0.100000
2020-10-26 15:25:09,203 epoch 2 - iter 880/2203 - loss 0.19609939 - samples/sec: 9.00 - lr: 0.100000
2020-10-26 15:31:48,577 epoch 2 - iter 1100/2203 - loss 0.19214788 - samples/sec: 9.14 - lr: 0.100000
2020-10-26 15:38:09,702 epoch 2 - iter 1320/2203 - loss 0.18789099 - samples/sec: 9.59 - lr: 0.100000
2020-10-26 15:44:44,340 epoch 2 - iter 1540/2203 - loss 0.18647896 - samples/sec: 9.26 - lr: 0.100000
2020-10-26 15:51:40,229 epoch 2 - iter 1760/2203 - loss 0.18428555 - samples/sec: 8.76 - lr: 0.100000
2020-10-26 15:58:29,640 epoch 2 - iter 1980/2203 - loss 0.18567216 - samples/sec: 8.93 - lr: 0.100000
2020-10-26 16:05:00,183 epoch 2 - iter 2200/2203 - loss 0.18587035 - samples/sec: 9.32 - lr: 0.100000
2020-10-26 16:05:05,354 ----------------------------------------------------------------------------------------------------
2020-10-26 16:05:05,357 EPOCH 2 done: loss 0.1859 - lr 0.1000000
2020-10-26 16:13:46,043 DEV : loss 0.20137515664100647 - score 0.9221
2020-10-26 16:14:10,586 BAD EPOCHS (no improvement): 1
2020-10-26 16:14:13,067 ----------------------------------------------------------------------------------------------------
2020-10-26 16:21:07,831 epoch 3 - iter 220/2203 - loss 0.18238298 - samples/sec: 8.79 - lr: 0.100000
2020-10-26 16:27:51,749 epoch 3 - iter 440/2203 - loss 0.17618999 - samples/sec: 9.06 - lr: 0.100000
2020-10-26 16:34:09,309 epoch 3 - iter 660/2203 - loss 0.17695219 - samples/sec: 9.69 - lr: 0.100000
2020-10-26 16:40:46,263 epoch 3 - iter 880/2203 - loss 0.17446990 - samples/sec: 9.24 - lr: 0.100000
2020-10-26 16:47:17,767 epoch 3 - iter 1100/2203 - loss 0.17715870 - samples/sec: 9.28 - lr: 0.100000
2020-10-26 16:53:33,697 epoch 3 - iter 1320/2203 - loss 0.17589824 - samples/sec: 9.75 - lr: 0.100000
2020-10-26 17:00:05,477 epoch 3 - iter 1540/2203 - loss 0.16927926 - samples/sec: 9.36 - lr: 0.100000
2020-10-26 17:07:00,212 epoch 3 - iter 1760/2203 - loss 0.15865498 - samples/sec: 8.85 - lr: 0.100000
2020-10-26 17:13:34,857 epoch 3 - iter 1980/2203 - loss 0.14524855 - samples/sec: 9.26 - lr: 0.100000
2020-10-26 17:20:04,330 epoch 3 - iter 2200/2203 - loss 0.13271315 - samples/sec: 9.42 - lr: 0.100000
2020-10-26 17:20:08,318 ----------------------------------------------------------------------------------------------------
2020-10-26 17:20:08,319 EPOCH 3 done: loss 0.1325 - lr 0.1000000
2020-10-26 17:28:44,729 DEV : loss 0.012024622410535812 - score 0.9973
2020-10-26 17:29:09,458 BAD EPOCHS (no improvement): 0
saving best model
2020-10-26 17:29:15,016 ----------------------------------------------------------------------------------------------------
2020-10-26 17:35:50,377 epoch 4 - iter 220/2203 - loss 0.01913221 - samples/sec: 9.25 - lr: 0.100000
2020-10-26 17:42:41,706 epoch 4 - iter 440/2203 - loss 0.01686669 - samples/sec: 8.88 - lr: 0.100000
2020-10-26 17:49:18,403 epoch 4 - iter 660/2203 - loss 0.01637001 - samples/sec: 9.22 - lr: 0.100000
2020-10-26 17:55:30,563 epoch 4 - iter 880/2203 - loss 0.01793630 - samples/sec: 9.82 - lr: 0.100000
2020-10-26 18:01:51,865 epoch 4 - iter 1100/2203 - loss 0.01778993 - samples/sec: 9.61 - lr: 0.100000
2020-10-26 18:08:10,067 epoch 4 - iter 1320/2203 - loss 0.01721206 - samples/sec: 9.71 - lr: 0.100000
2020-10-26 18:15:08,790 epoch 4 - iter 1540/2203 - loss 0.01605266 - samples/sec: 8.73 - lr: 0.100000
2020-10-26 18:21:51,057 epoch 4 - iter 1760/2203 - loss 0.01635847 - samples/sec: 9.09 - lr: 0.100000
2020-10-26 18:28:39,792 epoch 4 - iter 1980/2203 - loss 0.01645563 - samples/sec: 8.91 - lr: 0.100000
2020-10-26 18:35:04,839 epoch 4 - iter 2200/2203 - loss 0.01612705 - samples/sec: 9.54 - lr: 0.100000
2020-10-26 18:35:08,989 ----------------------------------------------------------------------------------------------------
2020-10-26 18:35:08,993 EPOCH 4 done: loss 0.0161 - lr 0.1000000
2020-10-26 18:43:41,242 DEV : loss 0.009354319423437119 - score 0.998
2020-10-26 18:44:05,388 BAD EPOCHS (no improvement): 0
saving best model
2020-10-26 18:44:10,345 ----------------------------------------------------------------------------------------------------
2020-10-27 04:40:50,330 epoch 5 - iter 220/2203 - loss 0.01027225 - samples/sec: 9.13 - lr: 0.100000
2020-10-27 04:47:29,905 epoch 5 - iter 440/2203 - loss 0.02770915 - samples/sec: 9.20 - lr: 0.100000
2020-10-27 04:54:13,620 epoch 5 - iter 660/2203 - loss 0.02306840 - samples/sec: 9.14 - lr: 0.100000
2020-10-27 05:01:07,121 epoch 5 - iter 880/2203 - loss 0.01932966 - samples/sec: 8.90 - lr: 0.100000
2020-10-27 05:07:34,036 epoch 5 - iter 1100/2203 - loss 0.01699685 - samples/sec: 9.49 - lr: 0.100000
2020-10-27 05:14:08,214 epoch 5 - iter 1320/2203 - loss 0.01609336 - samples/sec: 9.24 - lr: 0.100000
2020-10-27 05:20:47,161 epoch 5 - iter 1540/2203 - loss 0.01550904 - samples/sec: 9.20 - lr: 0.100000
2020-10-27 05:27:22,510 epoch 5 - iter 1760/2203 - loss 0.01522869 - samples/sec: 9.29 - lr: 0.100000
2020-10-27 05:34:15,166 epoch 5 - iter 1980/2203 - loss 0.01408969 - samples/sec: 8.87 - lr: 0.100000
2020-10-27 05:41:45,423 epoch 5 - iter 2200/2203 - loss 0.01613285 - samples/sec: 8.15 - lr: 0.100000
2020-10-27 05:41:49,900 ----------------------------------------------------------------------------------------------------
2020-10-27 05:41:49,901 EPOCH 5 done: loss 0.0161 - lr 0.1000000
2020-10-27 05:50:15,290 DEV : loss 0.007915562950074673 - score 0.9982
2020-10-27 05:50:39,378 BAD EPOCHS (no improvement): 0
saving best model
2020-10-27 05:50:45,090 ----------------------------------------------------------------------------------------------------
2020-10-27 05:57:21,085 epoch 6 - iter 220/2203 - loss 0.01015635 - samples/sec: 9.29 - lr: 0.100000
2020-10-27 06:04:01,229 epoch 6 - iter 440/2203 - loss 0.00987477 - samples/sec: 9.19 - lr: 0.100000
2020-10-27 06:10:53,216 epoch 6 - iter 660/2203 - loss 0.00969201 - samples/sec: 8.98 - lr: 0.100000
2020-10-27 06:18:14,455 epoch 6 - iter 880/2203 - loss 0.01076137 - samples/sec: 8.28 - lr: 0.100000
2020-10-27 06:24:56,074 epoch 6 - iter 1100/2203 - loss 0.01063478 - samples/sec: 9.11 - lr: 0.100000
2020-10-27 06:31:54,223 epoch 6 - iter 1320/2203 - loss 0.01056838 - samples/sec: 8.71 - lr: 0.100000
2020-10-27 06:38:37,920 epoch 6 - iter 1540/2203 - loss 0.00988410 - samples/sec: 9.13 - lr: 0.100000
2020-10-27 06:45:28,313 epoch 6 - iter 1760/2203 - loss 0.00986255 - samples/sec: 8.91 - lr: 0.100000
2020-10-27 06:52:10,201 epoch 6 - iter 1980/2203 - loss 0.00989472 - samples/sec: 9.18 - lr: 0.100000
2020-10-27 06:58:58,328 epoch 6 - iter 2200/2203 - loss 0.00948950 - samples/sec: 8.96 - lr: 0.100000
2020-10-27 06:59:02,154 ----------------------------------------------------------------------------------------------------
2020-10-27 06:59:02,155 EPOCH 6 done: loss 0.0095 - lr 0.1000000
2020-10-27 07:07:33,096 DEV : loss 0.0071281325072050095 - score 0.9982
2020-10-27 07:07:58,199 BAD EPOCHS (no improvement): 0
saving best model
2020-10-27 07:08:03,665 ----------------------------------------------------------------------------------------------------
2020-10-27 07:15:24,425 epoch 7 - iter 220/2203 - loss 0.00424439 - samples/sec: 8.28 - lr: 0.100000
2020-10-27 07:22:40,495 epoch 7 - iter 440/2203 - loss 0.05033240 - samples/sec: 8.41 - lr: 0.100000
2020-10-27 07:29:21,879 epoch 7 - iter 660/2203 - loss 0.03773144 - samples/sec: 9.21 - lr: 0.100000
2020-10-27 07:36:03,148 epoch 7 - iter 880/2203 - loss 0.03172533 - samples/sec: 9.22 - lr: 0.100000
2020-10-27 07:43:04,969 epoch 7 - iter 1100/2203 - loss 0.02753410 - samples/sec: 8.67 - lr: 0.100000
2020-10-27 07:50:02,450 epoch 7 - iter 1320/2203 - loss 0.02524895 - samples/sec: 8.79 - lr: 0.100000
2020-10-27 07:56:42,331 epoch 7 - iter 1540/2203 - loss 0.02232972 - samples/sec: 9.19 - lr: 0.100000
2020-10-27 08:03:44,921 epoch 7 - iter 1760/2203 - loss 0.02026714 - samples/sec: 8.60 - lr: 0.100000
2020-10-27 08:10:36,435 epoch 7 - iter 1980/2203 - loss 0.01852800 - samples/sec: 8.91 - lr: 0.100000
2020-10-27 08:17:14,397 epoch 7 - iter 2200/2203 - loss 0.01748303 - samples/sec: 9.20 - lr: 0.100000
2020-10-27 08:17:18,908 ----------------------------------------------------------------------------------------------------
2020-10-27 08:17:18,909 EPOCH 7 done: loss 0.0175 - lr 0.1000000
2020-10-27 08:25:56,840 DEV : loss 0.005925783887505531 - score 0.9984
2020-10-27 08:26:22,807 BAD EPOCHS (no improvement): 0
saving best model
2020-10-27 08:26:28,385 ----------------------------------------------------------------------------------------------------
2020-10-27 08:33:09,232 epoch 8 - iter 220/2203 - loss 0.01245051 - samples/sec: 9.18 - lr: 0.100000
2020-10-27 08:40:05,982 epoch 8 - iter 440/2203 - loss 0.00896036 - samples/sec: 8.76 - lr: 0.100000
2020-10-27 08:46:53,732 epoch 8 - iter 660/2203 - loss 0.00946345 - samples/sec: 9.01 - lr: 0.100000
2020-10-27 08:54:08,654 epoch 8 - iter 880/2203 - loss 0.00789385 - samples/sec: 8.42 - lr: 0.100000
2020-10-27 09:01:33,656 epoch 8 - iter 1100/2203 - loss 0.00807064 - samples/sec: 8.20 - lr: 0.100000
2020-10-27 09:08:21,315 epoch 8 - iter 1320/2203 - loss 0.00734514 - samples/sec: 9.07 - lr: 0.100000
2020-10-27 09:15:19,981 epoch 8 - iter 1540/2203 - loss 0.00683986 - samples/sec: 8.74 - lr: 0.100000
2020-10-27 09:22:13,866 epoch 8 - iter 1760/2203 - loss 0.00659387 - samples/sec: 8.83 - lr: 0.100000
2020-10-27 09:29:18,585 epoch 8 - iter 1980/2203 - loss 0.00735957 - samples/sec: 8.69 - lr: 0.100000
2020-10-27 09:36:22,727 epoch 8 - iter 2200/2203 - loss 0.00718531 - samples/sec: 8.66 - lr: 0.100000
2020-10-27 09:36:27,631 ----------------------------------------------------------------------------------------------------
2020-10-27 09:36:27,635 EPOCH 8 done: loss 0.0072 - lr 0.1000000
2020-10-27 09:45:11,425 DEV : loss 0.007020766381174326 - score 0.9982
2020-10-27 09:45:38,588 BAD EPOCHS (no improvement): 1
2020-10-27 09:45:41,452 ----------------------------------------------------------------------------------------------------
2020-10-27 09:52:37,353 epoch 9 - iter 220/2203 - loss 0.00451331 - samples/sec: 8.78 - lr: 0.100000
2020-10-27 09:59:34,068 epoch 9 - iter 440/2203 - loss 0.00432282 - samples/sec: 8.77 - lr: 0.100000
2020-10-27 10:06:12,370 epoch 9 - iter 660/2203 - loss 0.00480669 - samples/sec: 9.26 - lr: 0.100000
2020-10-27 10:13:15,947 epoch 9 - iter 880/2203 - loss 0.00396207 - samples/sec: 8.68 - lr: 0.100000
2020-10-27 10:20:03,224 epoch 9 - iter 1100/2203 - loss 0.00492271 - samples/sec: 8.99 - lr: 0.100000
2020-10-27 10:26:51,844 epoch 9 - iter 1320/2203 - loss 0.00466537 - samples/sec: 9.04 - lr: 0.100000
2020-10-27 10:34:20,737 epoch 9 - iter 1540/2203 - loss 0.00520344 - samples/sec: 8.15 - lr: 0.100000
2020-10-27 10:41:19,923 epoch 9 - iter 1760/2203 - loss 0.00483046 - samples/sec: 8.75 - lr: 0.100000
2020-10-27 10:48:45,343 epoch 9 - iter 1980/2203 - loss 0.00532501 - samples/sec: 8.25 - lr: 0.100000
2020-10-27 10:55:42,531 epoch 9 - iter 2200/2203 - loss 0.00543436 - samples/sec: 8.78 - lr: 0.100000
2020-10-27 10:55:47,569 ----------------------------------------------------------------------------------------------------
2020-10-27 10:55:47,573 EPOCH 9 done: loss 0.0054 - lr 0.1000000
2020-10-27 11:04:34,577 DEV : loss 0.005784482229501009 - score 0.9986
2020-10-27 11:05:01,790 BAD EPOCHS (no improvement): 0
saving best model
2020-10-27 11:05:07,597 ----------------------------------------------------------------------------------------------------
2020-10-27 11:12:17,736 epoch 10 - iter 220/2203 - loss 0.00331325 - samples/sec: 8.52 - lr: 0.100000
2020-10-27 11:19:12,462 epoch 10 - iter 440/2203 - loss 0.00307648 - samples/sec: 8.86 - lr: 0.100000
2020-10-27 11:26:46,216 epoch 10 - iter 660/2203 - loss 0.00397397 - samples/sec: 8.11 - lr: 0.100000
2020-10-27 11:33:42,170 epoch 10 - iter 880/2203 - loss 0.00383091 - samples/sec: 8.82 - lr: 0.100000
2020-10-27 11:40:19,396 epoch 10 - iter 1100/2203 - loss 0.00383989 - samples/sec: 9.23 - lr: 0.100000
2020-10-27 11:47:22,563 epoch 10 - iter 1320/2203 - loss 0.00359081 - samples/sec: 8.73 - lr: 0.100000
2020-10-27 11:54:10,428 epoch 10 - iter 1540/2203 - loss 0.00353515 - samples/sec: 8.96 - lr: 0.100000
2020-10-27 12:01:29,187 epoch 10 - iter 1760/2203 - loss 0.00454362 - samples/sec: 8.36 - lr: 0.100000
2020-10-27 12:08:22,683 epoch 10 - iter 1980/2203 - loss 0.00463832 - samples/sec: 8.90 - lr: 0.100000
2020-10-27 12:15:35,022 epoch 10 - iter 2200/2203 - loss 0.00431146 - samples/sec: 8.48 - lr: 0.100000
2020-10-27 12:15:38,823 ----------------------------------------------------------------------------------------------------
2020-10-27 12:15:38,824 EPOCH 10 done: loss 0.0044 - lr 0.1000000
2020-10-27 12:24:25,471 DEV : loss 0.005790039896965027 - score 0.9986
2020-10-27 12:24:52,873 BAD EPOCHS (no improvement): 1
2020-10-27 12:24:58,593 ----------------------------------------------------------------------------------------------------
2020-10-27 12:24:58,594 Testing using best model ...
2020-10-27 12:24:58,596 loading file best-model.pt
2020-10-27 12:31:51,235 	0.9982
2020-10-27 12:31:51,236 
Results:
- F-score (micro) 0.9982
- F-score (macro) 0.9982
- Accuracy 0.9981

By class:
              precision    recall  f1-score   support

           1     0.9978    0.9987    0.9983      2292
           0     0.9986    0.9976    0.9981      2113

   micro avg     0.9982    0.9982    0.9982      4405
   macro avg     0.9982    0.9982    0.9982      4405
weighted avg     0.9982    0.9982    0.9982      4405
 samples avg     0.9982    0.9982    0.9982      4405

2020-10-27 12:31:51,237 ----------------------------------------------------------------------------------------------------
{'dev_loss_history': [0.007915562950074673,
  0.0071281325072050095,
  0.005925783887505531,
  0.007020766381174326,
  0.005784482229501009,
  0.005790039896965027],
 'dev_score_history': [0.9982, 0.9982, 0.9984, 0.9982, 0.9986, 0.9986],
 'test_score': 0.9982,
 'train_loss_history': [0.016112424498317818,
  0.009478498110439415,
  0.01745975571585234,
  0.007176098632526979,
  0.0054288300712837185,
  0.0043605043210136335]}